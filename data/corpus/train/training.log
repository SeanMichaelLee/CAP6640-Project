2020-04-14 09:00:05,584 ----------------------------------------------------------------------------------------------------
2020-04-14 09:00:05,584 Model: "TextClassifier(
  (document_embeddings): DocumentRNNEmbeddings(
    (embeddings): StackedEmbeddings(
      (list_embedding_0): WordEmbeddings('glove')
    )
    (word_reprojection_map): Linear(in_features=100, out_features=100, bias=True)
    (rnn): GRU(100, 512, batch_first=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (decoder): Linear(in_features=512, out_features=3, bias=True)
  (loss_function): CrossEntropyLoss()
  (beta): 1.0
  (weights): None
  (weight_tensor) None
)"
2020-04-14 09:00:05,584 ----------------------------------------------------------------------------------------------------
2020-04-14 09:00:05,585 Corpus: "Corpus: 3373 train + 469 dev + 428 test sentences"
2020-04-14 09:00:05,585 ----------------------------------------------------------------------------------------------------
2020-04-14 09:00:05,585 Parameters:
2020-04-14 09:00:05,585  - learning_rate: "0.6"
2020-04-14 09:00:05,585  - mini_batch_size: "32"
2020-04-14 09:00:05,585  - patience: "5"
2020-04-14 09:00:05,585  - anneal_factor: "0.5"
2020-04-14 09:00:05,585  - max_epochs: "10"
2020-04-14 09:00:05,585  - shuffle: "True"
2020-04-14 09:00:05,586  - train_with_dev: "False"
2020-04-14 09:00:05,586  - batch_growth_annealing: "False"
2020-04-14 09:00:05,586 ----------------------------------------------------------------------------------------------------
2020-04-14 09:00:05,586 Model training base path: "data/corpus/train"
2020-04-14 09:00:05,586 ----------------------------------------------------------------------------------------------------
2020-04-14 09:00:05,586 Device: cpu
2020-04-14 09:00:05,586 ----------------------------------------------------------------------------------------------------
2020-04-14 09:00:05,586 Embeddings storage mode: cpu
2020-04-14 09:00:05,595 ----------------------------------------------------------------------------------------------------
2020-04-14 09:01:12,186 epoch 1 - iter 10/106 - loss 5.15301669 - samples/sec: 4.85
2020-04-14 09:02:17,035 epoch 1 - iter 20/106 - loss 4.84316507 - samples/sec: 4.97
2020-04-14 09:03:19,567 epoch 1 - iter 30/106 - loss 4.99501191 - samples/sec: 5.16
2020-04-14 09:04:19,712 epoch 1 - iter 40/106 - loss 4.76892053 - samples/sec: 5.37
2020-04-14 09:05:15,074 epoch 1 - iter 50/106 - loss 4.66336542 - samples/sec: 5.83
2020-04-14 09:06:20,733 epoch 1 - iter 60/106 - loss 4.63238186 - samples/sec: 4.88
2020-04-14 09:07:25,314 epoch 1 - iter 70/106 - loss 4.66193047 - samples/sec: 5.00
2020-04-14 09:08:27,349 epoch 1 - iter 80/106 - loss 4.48434440 - samples/sec: 5.20
2020-04-14 09:09:17,678 epoch 1 - iter 90/106 - loss 4.44597955 - samples/sec: 6.38
2020-04-14 09:10:14,307 epoch 1 - iter 100/106 - loss 4.27068187 - samples/sec: 5.71
2020-04-14 09:10:51,733 ----------------------------------------------------------------------------------------------------
2020-04-14 09:10:51,734 EPOCH 1 done: loss 4.2365 - lr 0.6000
2020-04-14 09:10:54,740 DEV : loss 2.125377893447876 - score 0.5443
2020-04-14 09:10:56,147 BAD EPOCHS (no improvement): 0
2020-04-14 09:10:58,944 ----------------------------------------------------------------------------------------------------
2020-04-14 09:11:49,935 epoch 2 - iter 10/106 - loss 2.96522481 - samples/sec: 6.38
2020-04-14 09:12:53,167 epoch 2 - iter 20/106 - loss 2.98576260 - samples/sec: 5.10
2020-04-14 09:13:46,336 epoch 2 - iter 30/106 - loss 2.89036144 - samples/sec: 6.04
2020-04-14 09:14:34,253 epoch 2 - iter 40/106 - loss 2.59247547 - samples/sec: 6.75
2020-04-14 09:15:28,117 epoch 2 - iter 50/106 - loss 2.69869330 - samples/sec: 5.99
2020-04-14 09:16:26,774 epoch 2 - iter 60/106 - loss 2.69217968 - samples/sec: 5.50
2020-04-14 09:17:22,703 epoch 2 - iter 70/106 - loss 2.58711186 - samples/sec: 5.78
2020-04-14 09:18:10,676 epoch 2 - iter 80/106 - loss 2.44470094 - samples/sec: 6.74
2020-04-14 09:19:05,911 epoch 2 - iter 90/106 - loss 2.35174226 - samples/sec: 5.81
2020-04-14 09:19:56,627 epoch 2 - iter 100/106 - loss 2.26316276 - samples/sec: 6.38
2020-04-14 09:20:23,793 ----------------------------------------------------------------------------------------------------
2020-04-14 09:20:23,799 EPOCH 2 done: loss 2.2026 - lr 0.6000
2020-04-14 09:20:28,206 DEV : loss 1.1724642515182495 - score 0.5763
2020-04-14 09:20:29,651 BAD EPOCHS (no improvement): 0
2020-04-14 09:20:32,402 ----------------------------------------------------------------------------------------------------
2020-04-14 09:21:25,885 epoch 3 - iter 10/106 - loss 1.65062073 - samples/sec: 6.07
2020-04-14 09:22:15,417 epoch 3 - iter 20/106 - loss 1.48492014 - samples/sec: 6.52
2020-04-14 09:23:11,980 epoch 3 - iter 30/106 - loss 1.53568258 - samples/sec: 5.67
2020-04-14 09:24:04,041 epoch 3 - iter 40/106 - loss 1.50285448 - samples/sec: 6.21
2020-04-14 09:25:07,602 epoch 3 - iter 50/106 - loss 1.43478001 - samples/sec: 5.08
2020-04-14 09:25:48,918 epoch 3 - iter 60/106 - loss 1.38418028 - samples/sec: 7.83
2020-04-14 09:26:45,889 epoch 3 - iter 70/106 - loss 1.39560098 - samples/sec: 5.63
2020-04-14 09:27:42,074 epoch 3 - iter 80/106 - loss 1.36021524 - samples/sec: 5.75
2020-04-14 09:28:27,915 epoch 3 - iter 90/106 - loss 1.33134724 - samples/sec: 7.05
2020-04-14 09:29:13,893 epoch 3 - iter 100/106 - loss 1.34727048 - samples/sec: 7.03
2020-04-14 09:29:44,450 ----------------------------------------------------------------------------------------------------
2020-04-14 09:29:44,451 EPOCH 3 done: loss 1.3309 - lr 0.6000
2020-04-14 09:29:47,504 DEV : loss 0.829657256603241 - score 0.54
2020-04-14 09:29:48,954 BAD EPOCHS (no improvement): 1
2020-04-14 09:29:48,955 ----------------------------------------------------------------------------------------------------
2020-04-14 09:30:39,291 epoch 4 - iter 10/106 - loss 1.49327093 - samples/sec: 6.48
2020-04-14 09:31:36,006 epoch 4 - iter 20/106 - loss 1.50279402 - samples/sec: 5.69
2020-04-14 09:32:30,164 epoch 4 - iter 30/106 - loss 1.49089699 - samples/sec: 5.96
2020-04-14 09:33:25,265 epoch 4 - iter 40/106 - loss 1.42077931 - samples/sec: 5.87
2020-04-14 09:34:21,600 epoch 4 - iter 50/106 - loss 1.35284675 - samples/sec: 5.74
2020-04-14 09:35:07,222 epoch 4 - iter 60/106 - loss 1.31811493 - samples/sec: 7.03
2020-04-14 09:35:56,995 epoch 4 - iter 70/106 - loss 1.30229604 - samples/sec: 6.50
2020-04-14 09:36:40,743 epoch 4 - iter 80/106 - loss 1.26981780 - samples/sec: 7.41
2020-04-14 09:37:28,416 epoch 4 - iter 90/106 - loss 1.25151592 - samples/sec: 6.73
2020-04-14 09:38:24,772 epoch 4 - iter 100/106 - loss 1.22593423 - samples/sec: 5.73
2020-04-14 09:39:03,349 ----------------------------------------------------------------------------------------------------
2020-04-14 09:39:03,349 EPOCH 4 done: loss 1.2251 - lr 0.6000
2020-04-14 09:39:06,272 DEV : loss 1.2767188549041748 - score 0.4653
2020-04-14 09:39:07,721 BAD EPOCHS (no improvement): 2
2020-04-14 09:39:07,728 ----------------------------------------------------------------------------------------------------
2020-04-14 09:39:58,964 epoch 5 - iter 10/106 - loss 1.35030226 - samples/sec: 6.35
2020-04-14 09:40:45,420 epoch 5 - iter 20/106 - loss 1.17234043 - samples/sec: 6.96
2020-04-14 09:41:43,373 epoch 5 - iter 30/106 - loss 1.17903847 - samples/sec: 5.53
2020-04-14 09:42:36,566 epoch 5 - iter 40/106 - loss 1.16338025 - samples/sec: 6.08
2020-04-14 09:43:27,117 epoch 5 - iter 50/106 - loss 1.14445941 - samples/sec: 6.39
2020-04-14 09:44:23,397 epoch 5 - iter 60/106 - loss 1.10720480 - samples/sec: 5.73
2020-04-14 09:45:09,586 epoch 5 - iter 70/106 - loss 1.08086302 - samples/sec: 7.01
2020-04-14 09:46:00,513 epoch 5 - iter 80/106 - loss 1.07345721 - samples/sec: 6.35
2020-04-14 09:47:00,622 epoch 5 - iter 90/106 - loss 1.05000782 - samples/sec: 5.33
2020-04-14 09:47:51,529 epoch 5 - iter 100/106 - loss 1.04373501 - samples/sec: 6.36
2020-04-14 09:48:23,351 ----------------------------------------------------------------------------------------------------
2020-04-14 09:48:23,351 EPOCH 5 done: loss 1.0303 - lr 0.6000
2020-04-14 09:48:27,086 DEV : loss 0.8324421048164368 - score 0.461
2020-04-14 09:48:28,559 BAD EPOCHS (no improvement): 3
2020-04-14 09:48:28,559 ----------------------------------------------------------------------------------------------------
2020-04-14 09:49:29,158 epoch 6 - iter 10/106 - loss 0.86855296 - samples/sec: 5.35
2020-04-14 09:50:26,886 epoch 6 - iter 20/106 - loss 0.86411956 - samples/sec: 5.59
2020-04-14 09:51:24,828 epoch 6 - iter 30/106 - loss 0.88529127 - samples/sec: 5.53
2020-04-14 09:52:10,342 epoch 6 - iter 40/106 - loss 0.89155871 - samples/sec: 7.11
2020-04-14 09:53:03,931 epoch 6 - iter 50/106 - loss 0.86522457 - samples/sec: 6.04
2020-04-14 09:53:50,502 epoch 6 - iter 60/106 - loss 0.85956758 - samples/sec: 6.89
2020-04-14 09:54:45,018 epoch 6 - iter 70/106 - loss 0.86119027 - samples/sec: 5.93
2020-04-14 09:55:38,105 epoch 6 - iter 80/106 - loss 0.84597336 - samples/sec: 6.09
2020-04-14 09:56:24,583 epoch 6 - iter 90/106 - loss 0.84819511 - samples/sec: 6.95
2020-04-14 09:57:19,342 epoch 6 - iter 100/106 - loss 0.83966949 - samples/sec: 5.90
2020-04-14 09:57:46,634 ----------------------------------------------------------------------------------------------------
2020-04-14 09:57:46,634 EPOCH 6 done: loss 0.8371 - lr 0.6000
2020-04-14 09:57:49,662 DEV : loss 0.7288385033607483 - score 0.4418
2020-04-14 09:57:51,096 BAD EPOCHS (no improvement): 4
2020-04-14 09:57:51,097 ----------------------------------------------------------------------------------------------------
2020-04-14 09:58:44,413 epoch 7 - iter 10/106 - loss 0.75658519 - samples/sec: 6.11
2020-04-14 09:59:37,520 epoch 7 - iter 20/106 - loss 0.73117853 - samples/sec: 6.08
2020-04-14 10:00:35,119 epoch 7 - iter 30/106 - loss 0.74778683 - samples/sec: 5.60
2020-04-14 10:01:34,860 epoch 7 - iter 40/106 - loss 0.74270013 - samples/sec: 5.41
2020-04-14 10:02:33,295 epoch 7 - iter 50/106 - loss 0.73625455 - samples/sec: 5.49
2020-04-14 10:03:23,134 epoch 7 - iter 60/106 - loss 0.74091784 - samples/sec: 6.49
2020-04-14 10:04:11,203 epoch 7 - iter 70/106 - loss 0.73626696 - samples/sec: 6.73
2020-04-14 10:04:58,563 epoch 7 - iter 80/106 - loss 0.73440109 - samples/sec: 6.83
2020-04-14 10:05:45,462 epoch 7 - iter 90/106 - loss 0.73240451 - samples/sec: 6.84
2020-04-14 10:06:42,363 epoch 7 - iter 100/106 - loss 0.73627250 - samples/sec: 5.68
2020-04-14 10:07:13,088 ----------------------------------------------------------------------------------------------------
2020-04-14 10:07:13,088 EPOCH 7 done: loss 0.7350 - lr 0.6000
2020-04-14 10:07:16,070 DEV : loss 0.7057057619094849 - score 0.572
2020-04-14 10:07:17,510 BAD EPOCHS (no improvement): 5
2020-04-14 10:07:17,511 ----------------------------------------------------------------------------------------------------
2020-04-14 10:08:12,597 epoch 8 - iter 10/106 - loss 0.72296504 - samples/sec: 5.90
2020-04-14 10:09:09,563 epoch 8 - iter 20/106 - loss 0.72655528 - samples/sec: 5.67
2020-04-14 10:10:00,239 epoch 8 - iter 30/106 - loss 0.72381092 - samples/sec: 6.33
2020-04-14 10:10:51,598 epoch 8 - iter 40/106 - loss 0.71796754 - samples/sec: 6.29
2020-04-14 10:11:39,372 epoch 8 - iter 50/106 - loss 0.71618508 - samples/sec: 6.77
2020-04-14 10:12:25,472 epoch 8 - iter 60/106 - loss 0.71156676 - samples/sec: 7.01
2020-04-14 10:13:21,375 epoch 8 - iter 70/106 - loss 0.70932551 - samples/sec: 5.74
2020-04-14 10:14:16,670 epoch 8 - iter 80/106 - loss 0.70938805 - samples/sec: 5.85
2020-04-14 10:15:13,101 epoch 8 - iter 90/106 - loss 0.71092057 - samples/sec: 5.72
2020-04-14 10:16:02,945 epoch 8 - iter 100/106 - loss 0.71437512 - samples/sec: 6.49
2020-04-14 10:16:32,470 ----------------------------------------------------------------------------------------------------
2020-04-14 10:16:32,471 EPOCH 8 done: loss 0.7145 - lr 0.6000
2020-04-14 10:16:35,557 DEV : loss 0.8272144198417664 - score 0.4247
2020-04-14 10:16:37,331 BAD EPOCHS (no improvement): 6
2020-04-14 10:16:37,332 ----------------------------------------------------------------------------------------------------
2020-04-14 10:17:36,833 epoch 9 - iter 10/106 - loss 0.72175344 - samples/sec: 5.41
2020-04-14 10:18:28,014 epoch 9 - iter 20/106 - loss 0.72063723 - samples/sec: 6.32
2020-04-14 10:19:16,405 epoch 9 - iter 30/106 - loss 0.71087152 - samples/sec: 6.67
2020-04-14 10:20:17,070 epoch 9 - iter 40/106 - loss 0.70789165 - samples/sec: 5.32
2020-04-14 10:21:10,428 epoch 9 - iter 50/106 - loss 0.70573229 - samples/sec: 6.06
2020-04-14 10:21:59,703 epoch 9 - iter 60/106 - loss 0.70517184 - samples/sec: 6.51
2020-04-14 10:22:45,547 epoch 9 - iter 70/106 - loss 0.70332356 - samples/sec: 7.07
2020-04-14 10:23:39,688 epoch 9 - iter 80/106 - loss 0.70134821 - samples/sec: 5.97
2020-04-14 10:24:34,303 epoch 9 - iter 90/106 - loss 0.70122688 - samples/sec: 5.91
2020-04-14 10:25:26,114 epoch 9 - iter 100/106 - loss 0.70197294 - samples/sec: 6.20
2020-04-14 10:25:50,171 ----------------------------------------------------------------------------------------------------
2020-04-14 10:25:50,172 EPOCH 9 done: loss 0.7004 - lr 0.3000
2020-04-14 10:25:53,172 DEV : loss 0.6916652321815491 - score 0.5614
2020-04-14 10:25:54,648 BAD EPOCHS (no improvement): 1
2020-04-14 10:25:54,649 ----------------------------------------------------------------------------------------------------
2020-04-14 10:26:44,151 epoch 10 - iter 10/106 - loss 0.68965203 - samples/sec: 6.57
2020-04-14 10:27:41,068 epoch 10 - iter 20/106 - loss 0.70427471 - samples/sec: 5.68
2020-04-14 10:28:36,091 epoch 10 - iter 30/106 - loss 0.70412817 - samples/sec: 5.83
2020-04-14 10:29:39,056 epoch 10 - iter 40/106 - loss 0.70664931 - samples/sec: 5.13
2020-04-14 10:30:30,053 epoch 10 - iter 50/106 - loss 0.70443689 - samples/sec: 6.34
2020-04-14 10:31:30,806 epoch 10 - iter 60/106 - loss 0.70336140 - samples/sec: 5.31
2020-04-14 10:32:38,324 epoch 10 - iter 70/106 - loss 0.70233661 - samples/sec: 4.79
2020-04-14 10:33:30,848 epoch 10 - iter 80/106 - loss 0.69939700 - samples/sec: 6.16
2020-04-14 10:34:16,866 epoch 10 - iter 90/106 - loss 0.69988678 - samples/sec: 6.97
2020-04-14 10:35:18,406 epoch 10 - iter 100/106 - loss 0.70067556 - samples/sec: 5.26
2020-04-14 10:35:52,075 ----------------------------------------------------------------------------------------------------
2020-04-14 10:35:52,080 EPOCH 10 done: loss 0.7014 - lr 0.3000
2020-04-14 10:35:56,934 DEV : loss 0.6948785185813904 - score 0.5742
2020-04-14 10:35:58,530 BAD EPOCHS (no improvement): 2
2020-04-14 10:36:01,647 ----------------------------------------------------------------------------------------------------
2020-04-14 10:36:01,647 Testing using best model ...
2020-04-14 10:36:01,648 loading file data/corpus/train/best-model.pt
2020-04-14 10:36:06,513 0.5023	0.5023	0.5023
2020-04-14 10:36:06,515 
MICRO_AVG: acc 0.3354 - f1-score 0.5023
MACRO_AVG: acc 0.2132 - f1-score 0.31693333333333334
0          tp: 156 - fp: 145 - fn: 68 - tn: 59 - precision: 0.5183 - recall: 0.6964 - accuracy: 0.4228 - f1-score: 0.5943
1          tp: 59 - fp: 68 - fn: 145 - tn: 156 - precision: 0.4646 - recall: 0.2892 - accuracy: 0.2169 - f1-score: 0.3565
﻿0         tp: 0 - fp: 0 - fn: 0 - tn: 428 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.0000 - f1-score: 0.0000
2020-04-14 10:36:06,515 ----------------------------------------------------------------------------------------------------
